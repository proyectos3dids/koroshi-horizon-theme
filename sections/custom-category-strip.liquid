{% comment %}
  Tira categorías (inputs) — sin puntos, subrayado al hacer clic,
  y toggle de carruseles por ID.
  Requisito: ocultar por defecto vía JS (display:none) y al seleccionar quitar ese "none"
  (no se añade block, solo se elimina la propiedad inline).
{% endcomment %}

{% assign S = section.settings %}

<style>
  #catstrip-{{ section.id }}{
    --text: {{ S.text_color }};
    --hover: {{ S.text_hover_color }};
    --accent: {{ S.accent_color }};
    --uline: {{ S.underline_color }};
    --fsize: {{ S.font_size | default: 18 }}px;
    --lspace: {{ S.letter_spacing | default: 0 }}px;
    --wbase: {{ S.font_weight }};
    --gap-d: {{ S.gap_desktop | default: 28 }}px;
    --gap-m: {{ S.gap_mobile | default: 18 }}px;
    --py: {{ S.padding_y | default: 16 }}px;
    --px: {{ S.padding_x | default: 0 }}px;
    --mt: {{ S.margin_top | default: 0 }}px;
    --mb: {{ S.margin_bottom | default: 0 }}px;
    --uline-thick: {{ S.underline_thickness | default: 2 }}px;
    --uline-off: {{ S.underline_offset | default: 3 }}px;
    --maxw: {% if S.max_width != blank %}{{ S.max_width }}{% else %}100%{% endif %};
  }
  #catstrip-{{ section.id }}{ margin-top:var(--mt); margin-bottom:var(--mb); }
  #catstrip-{{ section.id }} .wrap{ max-width:var(--maxw); margin:0 auto; padding:var(--py) var(--px); }
  #catstrip-{{ section.id }} .list{
    display:flex; align-items:center; gap:var(--gap-m);
    justify-content:{% case S.align %}{% when 'center' %}center{% when 'right' %}flex-end{% else %}flex-start{% endcase %};
    flex-wrap:{% if S.wrap_mobile %}wrap{% else %}nowrap{% endif %};
    list-style:none; margin:0; padding:0; /* sin puntos */
  }
  @media (min-width:768px){ #catstrip-{{ section.id }} .list{ gap:var(--gap-d); flex-wrap:nowrap; } }

  #catstrip-{{ section.id }} .item{
    position:relative; font-size:var(--fsize); letter-spacing:var(--lspace);
    font-weight:var(--wbase); line-height:1.1;
    text-transform:{% if S.uppercase %}uppercase{% else %}none{% endif %};
    cursor:pointer;
  }
  #catstrip-{{ section.id }} .link{
    display:inline-block; color:var(--text); text-decoration:none;
    padding-bottom:calc(var(--uline-off) + var(--uline-thick));
    transition:color .2s ease, opacity .2s ease, transform .2s ease;
  }
  #catstrip-{{ section.id }} .link:hover{ color:var(--hover); }

  /* Resaltado por color */
  #catstrip-{{ section.id }} .item[data-accent="true"] .link{
    color:var(--accent); {% if S.accent_bold %}font-weight:700;{% endif %}
  }

  /* Subrayado por ajustes o por clic (is-active) */
  #catstrip-{{ section.id }} .item[data-underline="true"] .link::after,
  #catstrip-{{ section.id }} .item.is-active .link::after{
    content:""; position:absolute; left:0; right:0; bottom:var(--uline-off);
    height:var(--uline-thick); background:var(--uline);
  }

  /* Negrita por ítem */
  #catstrip-{{ section.id }} .item[data-strong="true"] .link{ font-weight:700; }

  /* Enfoque accesible */
  #catstrip-{{ section.id }} .link:focus{ outline:2px solid var(--accent); outline-offset:2px; }
</style>

<section id="catstrip-{{ section.id }}" class="category-strip-simple 3didsprime-strip">
  <div class="wrap">
    <nav aria-label="{{ S.aria_label | default: 'Categorías' }}">
      <ul class="list" role="list">

        <!-- ITEM 1 -->
        <li class="item"
            data-target="{{ S.i1_target_id | escape }}"
            data-accent="{% if S.i1_accent %}true{% else %}false{% endif %}"
            data-underline="{% if S.i1_under %}true{% else %}false{% endif %}"
            data-strong="{% if S.i1_bold %}true{% else %}false{% endif %}">
          {% if S.i1_url != blank %}
            <a class="link" href="{{ S.i1_url }}" aria-label="{{ S.i1_label }}">{{ S.i1_label }}</a>
          {% else %}
            <span class="link" role="text" aria-label="{{ S.i1_label }}">{{ S.i1_label }}</span>
          {% endif %}
        </li>

        <!-- ITEM 2 -->
        <li class="item"
            data-target="{{ S.i2_target_id | escape }}"
            data-accent="{% if S.i2_accent %}true{% else %}false{% endif %}"
            data-underline="{% if S.i2_under %}true{% else %}false{% endif %}"
            data-strong="{% if S.i2_bold %}true{% else %}false{% endif %}">
          {% if S.i2_url != blank %}
            <a class="link" href="{{ S.i2_url }}" aria-label="{{ S.i2_label }}">{{ S.i2_label }}</a>
          {% else %}
            <span class="link" role="text" aria-label="{{ S.i2_label }}">{{ S.i2_label }}</span>
          {% endif %}
        </li>

        <!-- ITEM 3 -->
        <li class="item"
            data-target="{{ S.i3_target_id | escape }}"
            data-accent="{% if S.i3_accent %}true{% else %}false{% endif %}"
            data-underline="{% if S.i3_under %}true{% else %}false{% endif %}"
            data-strong="{% if S.i3_bold %}true{% else %}false{% endif %}">
          {% if S.i3_url != blank %}
            <a class="link" href="{{ S.i3_url }}" aria-label="{{ S.i3_label }}">{{ S.i3_label }}</a>
          {% else %}
            <span class="link" role="text" aria-label="{{ S.i3_label }}">{{ S.i3_label }}</span>
          {% endif %}
        </li>

        <!-- ITEM 4 -->
        <li class="item"
            data-target="{{ S.i4_target_id | escape }}"
            data-accent="{% if S.i4_accent %}true{% else %}false{% endif %}"
            data-underline="{% if S.i4_under %}true{% else %}false{% endif %}"
            data-strong="{% if S.i4_bold %}true{% else %}false{% endif %}">
          {% if S.i4_url != blank %}
            <a class="link" href="{{ S.i4_url }}" aria-label="{{ S.i4_label }}">{{ S.i4_label }}</a>
          {% else %}
            <span class="link" role="text" aria-label="{{ S.i4_label }}">{{ S.i4_label }}</span>
          {% endif %}
        </li>

        <!-- ITEM 5 -->
        <li class="item"
            data-target="{{ S.i5_target_id | escape }}"
            data-accent="{% if S.i5_accent %}true{% else %}false{% endif %}"
            data-underline="{% if S.i5_under %}true{% else %}false{% endif %}"
            data-strong="{% if S.i5_bold %}true{% else %}false{% endif %}">
          {% if S.i5_url != blank %}
            <a class="link" href="{{ S.i5_url }}" aria-label="{{ S.i5_label }}">{{ S.i5_label }}</a>
          {% else %}
            <span class="link" role="text" aria-label="{{ S.i5_label }}">{{ S.i5_label }}</span>
          {% endif %}
        </li>

      </ul>
    </nav>
  </div>
</section>

<script>
  (function(){
    var root = document.getElementById('catstrip-{{ section.id }}');
    if(!root) return;

    var items = root.querySelectorAll('.item');
    var links = root.querySelectorAll('.item .link');

    // IDs de carruseles (sin '#'), ignorando vacíos
    var targets = [
      "{{ S.i1_target_id | escape }}",
      "{{ S.i2_target_id | escape }}",
      "{{ S.i3_target_id | escape }}",
      "{{ S.i4_target_id | escape }}",
      "{{ S.i5_target_id | escape }}"
    ].filter(function(id){ return id && id.trim().length > 0; });

    function hideAll(){
      targets.forEach(function(id){
        var el = document.getElementById(id);
        if(el){
          el.style.display = 'none'; // poner none por defecto
        }
      });
    }
    function showOne(id){
      var el = document.getElementById(id);
      if(el){
        el.style.removeProperty('display'); // quitar el 'none' inline
      }
    }
    function clearActive(){
      items.forEach(function(li){ li.classList.remove('is-active'); });
    }

    // Al cargar: ocultar todos y mostrar el activo por defecto (si existe)
    hideAll();
    var defaultIndex = {{ S.default_active | default: 1 }}; // 1..5
    var defaultItem = items[defaultIndex - 1];
    if(defaultItem){
      var defId = defaultItem.getAttribute('data-target');
      if(defId){ showOne(defId); defaultItem.classList.add('is-active'); }
    }

    // Click: subraya y muestra carrusel objetivo (si existe)
    links.forEach(function(a){
      a.addEventListener('click', function(e){
        var li = a.closest('.item');
        if(!li) return;
        var targetId = li.getAttribute('data-target');
        if(targetId){
          e.preventDefault(); // control del toggle
          hideAll();
          showOne(targetId);  // solo quitamos el none
          clearActive();
          li.classList.add('is-active');
        }
      });
    });
  })();
</script>

{% schema %}
{
  "name": "Tira categorías (simple)",
  "class": "category-strip-simple",
  "settings": [
    { "type": "header", "content": "Diseño" },
    { "type": "select", "id": "align", "label": "Alineación", "default": "left",
      "options":[{"value":"left","label":"Izquierda"},{"value":"center","label":"Centrada"},{"value":"right","label":"Derecha"}] },
    { "type": "text", "id": "max_width", "label": "Anchura máxima (ej. 1200px o 100%)", "default": "1200px" },
    { "type": "range", "id": "gap_desktop", "label": "Separación (desktop, px)", "min": 0, "max": 80, "step": 1, "default": 28 },
    { "type": "range", "id": "gap_mobile", "label": "Separación (móvil, px)", "min": 0, "max": 60, "step": 1, "default": 18 },
    { "type": "checkbox", "id": "wrap_mobile", "label": "Permitir salto de línea en móvil", "default": true },

    { "type": "header", "content": "Tipografía" },
    { "type": "range", "id": "font_size", "label": "Tamaño (px)", "min": 10, "max": 48, "step": 1, "default": 18 },
    { "type": "select", "id": "font_weight", "label": "Peso base", "default": "600",
      "options":[{"value":"400","label":"400"},{"value":"500","label":"500"},{"value":"600","label":"600"},{"value":"700","label":"700"}] },
    { "type": "range", "id": "letter_spacing", "label": "Espaciado letras (px)", "min": -1, "max": 5, "step": 0.1, "default": 0 },
    { "type": "checkbox", "id": "uppercase", "label": "Mayúsculas", "default": true },

    { "type": "header", "content": "Colores" },
    { "type": "color", "id": "text_color", "label": "Texto", "default": "#111111" },
    { "type": "color", "id": "text_hover_color", "label": "Texto hover", "default": "#111111" },
    { "type": "color", "id": "accent_color", "label": "Acento (resaltado)", "default": "#F8C02E" },
    { "type": "color", "id": "underline_color", "label": "Subrayado", "default": "#111111" },
    { "type": "checkbox", "id": "accent_bold", "label": "Resaltados en negrita", "default": false },

    { "type": "header", "content": "Subrayado" },
    { "type": "range", "id": "underline_thickness", "label": "Grosor (px)", "min": 1, "max": 8, "step": 1, "default": 2 },
    { "type": "range", "id": "underline_offset", "label": "Separación inferior (px)", "min": 0, "max": 12, "step": 1, "default": 3 },

    { "type": "header", "content": "Espaciados" },
    { "type": "range", "id": "padding_y", "label": "Padding vertical (px)", "min": 0, "max": 60, "step": 1, "default": 16 },
    { "type": "range", "id": "padding_x", "label": "Padding horizontal (px)", "min": 0, "max": 120, "step": 2, "default": 0 },
    { "type": "range", "id": "margin_top", "label": "Margen superior (px)", "min": 0, "max": 120, "step": 2, "default": 0 },
    { "type": "range", "id": "margin_bottom", "label": "Margen inferior (px)", "min": 0, "max": 120, "step": 2, "default": 0 },

    { "type": "header", "content": "Accesibilidad" },
    { "type": "text", "id": "aria_label", "label": "Etiqueta ARIA del nav", "default": "Categorías" },

    { "type": "header", "content": "Activo por defecto" },
    { "type": "select", "id": "default_active", "label": "Ítem activo por defecto", "default": "1",
      "options": [
        { "value": "1", "label": "Item 1" },
        { "value": "2", "label": "Item 2" },
        { "value": "3", "label": "Item 3" },
        { "value": "4", "label": "Item 4" },
        { "value": "5", "label": "Item 5" }
      ]
    },

    { "type": "header", "content": "Item 1" },
    { "type": "text", "id": "i1_label", "label": "Texto", "default": "NEW IN" },
    { "type": "url", "id": "i1_url", "label": "Enlace (opcional)" },
    { "type": "text", "id": "i1_target_id", "label": "ID del carrusel objetivo (sin #)"},
    { "type": "checkbox", "id": "i1_accent", "label": "Resaltar con acento", "default": true },
    { "type": "checkbox", "id": "i1_under", "label": "Subrayado", "default": false },
    { "type": "checkbox", "id": "i1_bold", "label": "Negrita", "default": false },

    { "type": "header", "content": "Item 2" },
    { "type": "text", "id": "i2_label", "label": "Texto", "default": "MUJER" },
    { "type": "url", "id": "i2_url", "label": "Enlace (opcional)" },
    { "type": "text", "id": "i2_target_id", "label": "ID del carrusel objetivo (sin #)"},
    { "type": "checkbox", "id": "i2_accent", "label": "Resaltar con acento", "default": false },
    { "type": "checkbox", "id": "i2_under", "label": "Subrayado", "default": true },
    { "type": "checkbox", "id": "i2_bold", "label": "Negrita", "default": true },

    { "type": "header", "content": "Item 3" },
    { "type": "text", "id": "i3_label", "label": "Texto", "default": "HOMBRE" },
    { "type": "url", "id": "i3_url", "label": "Enlace (opcional)" },
    { "type": "text", "id": "i3_target_id", "label": "ID del carrusel objetivo (sin #)"},
    { "type": "checkbox", "id": "i3_accent", "label": "Resaltar con acento", "default": false },
    { "type": "checkbox", "id": "i3_under", "label": "Subrayado", "default": false },
    { "type": "checkbox", "id": "i3_bold", "label": "Negrita", "default": true },

    { "type": "header", "content": "Item 4" },
    { "type": "text", "id": "i4_label", "label": "Texto", "default": "KIDS" },
    { "type": "url", "id": "i4_url", "label": "Enlace (opcional)" },
    { "type": "text", "id": "i4_target_id", "label": "ID del carrusel objetivo (sin #)" },
    { "type": "checkbox", "id": "i4_accent", "label": "Resaltar con acento", "default": false },
    { "type": "checkbox", "id": "i4_under", "label": "Subrayado", "default": false },
    { "type": "checkbox", "id": "i4_bold", "label": "Negrita", "default": true },

    { "type": "header", "content": "Item 5" },
    { "type": "text", "id": "i5_label", "label": "Texto", "default": "REBAJAS" },
    { "type": "url", "id": "i5_url", "label": "Enlace (opcional)" },
    { "type": "text", "id": "i5_target_id", "label": "ID del carrusel objetivo (sin #)" },
    { "type": "checkbox", "id": "i5_accent", "label": "Resaltar con acento", "default": false },
    { "type": "checkbox", "id": "i5_under", "label": "Subrayado", "default": false },
    { "type": "checkbox", "id": "i5_bold", "label": "Negrita", "default": true }
  ],
  "presets": [
    { "name": "Tira de categorías (simple)", "category": "Texto" }
  ]
}
{% endschema %}
